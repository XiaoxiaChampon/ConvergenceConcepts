library(shiny)
library(ConvergenceConcepts)

# Define UI for application that draws a histogram
ui <- fluidPage(

    # Application title
    titlePanel("Central Limit Theorem"),

    # Sidebar with a slider input for number of bins 
    sidebarLayout(
        sidebarPanel(
            sliderInput("samples",
                        "number of samples from each sample size",
                        min = 1000,
                        max = 10000,
                        step=100,
                        value = 1500),
            sliderInput("samplesize",
                        "sample size",
                        min = 1,
                        max = 1000,
                        step=50,
                        value = 50),
            sliderInput("alpha",
                        "alpha",
                        min = 1,
                        max = 50,
                        step=5,
                        value = 3),
            sliderInput("beta",
                        "beta",
                        min = 1,
                        max = 50,
                        step=5,
                        value = 3)
          
                
            ),
            
    

        # Show a plot of the generated distribution
        mainPanel(
           plotOutput("distPlot"),
           plotOutput("distPlot1"),
           textOutput("mu" )
        )
    ))


# Define server logic required to draw a histogram
server <- function(input, output) {

    output$distPlot <- renderPlot({
        n=input$samples
        ns=input$samplesize
        alpha=input$alpha
        beta=input$beta
        myrgamma=function(n){mean(rgamma(1:n,shape=alpha,scale=beta))}
        data=generate(nmax=ns,M=n,myrgamma)$data
        hist(data,col="green",border = "red")
        
    })
    output$distPlot1 <- renderPlot({
        n=input$samples
        ns=input$samplesize
        alpha=input$alpha
        beta=input$beta
        myrgamma=function(n){mean(rgamma(1:n,shape=alpha,scale=beta))}
        data=generate(nmax=ns,M=n,myrgamma)$data
        visualize.sp(data,main="Ten sample paths", col="grey")
        
    })
    output$mu <- renderText({ 
        paste("mu=", input$alpha*input$beta)
    })
    
}

# Run the application 
shinyApp(ui = ui, server = server)
