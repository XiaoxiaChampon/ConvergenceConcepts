library(shiny)
library(ConvergenceConcepts)

# Define UI for application that draws a histogram
ui <- fluidPage(

    # Application title
    titlePanel("Central Limit Theorem"),

    # Sidebar with a slider input for number of bins 
    sidebarLayout(
        sidebarPanel(
            sliderInput("samples",
                        "number of samples from each sample size",
                        min = 1000,
                        max = 10000,
                        step=100,
                        value = 1500),
            sliderInput("samplesize",
                        "sample size",
                        min = 1,
                        max = 1000,
                        step=50,
                        value = 50),
            sliderInput("ave",
                        "mu",
                        min = 0,
                        max = 100,
                        step=5,
                        value = 10),
            sliderInput("sig",
                        "Standard deviation",
                        min = 1,
                        max = 50,
                        step=2,
                        value = 3)
            
        ),

        # Show a plot of the generated distribution
        mainPanel(
           plotOutput("distPlot"),
           plotOutput("distPlot1")
        )
    )
)

# Define server logic required to draw a histogram
server <- function(input, output) {

    output$distPlot <- renderPlot({
        n=input$samples
        ns=input$samplesize
        mu=input$ave
        sig=input$sig
        myrnorm=function(n){mean(rnorm(1:n,mean=mu,sd=sig))}
        data=generate(nmax=ns,M=n,myrnorm)$data
        hist(data)
        
    })
    output$distPlot1 <- renderPlot({
        n=input$samples
        ns=input$samplesize
        mu=input$ave
        sig=input$sig
        myrnorm=function(n){mean(rnorm(1:n,mean=mu,sd=sig))}
        data=generate(nmax=ns,M=n,myrnorm)$data
        visualize.sp(data,main="Ten sample paths", col="grey")
        
    })
}

# Run the application 
shinyApp(ui = ui, server = server)
